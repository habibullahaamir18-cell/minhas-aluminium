# Railway Deployment Configuration Guide
## Minhas Aluminium & Glass Corporation

---

## STEP 1: Update Railway Environment Variables

### 1.1 Access Railway Dashboard
1. Open your browser and go to: https://railway.app
2. Sign in to your account
3. Find and click on your project: "minhas-aluminium-backend-production"
4. Click on your backend service

### 1.2 Add/Update Environment Variables
1. Click on the "Variables" tab (or "Settings" → "Variables")
2. You need to add TWO environment variables:

**Variable 1: MONGO_URI**
- Click "New Variable" or "Add Variable"
- Variable Name: MONGO_URI
- Variable Value: mongodb+srv://habibullahaamir18_db_user:w651ezowTMXApQpL@minhasaluminium.ed28hoe.mongodb.net/minhas_db?retryWrites=true&w=majority
- Click "Add" or "Save"

**Variable 2: JWT_SECRET**
- Click "New Variable" or "Add Variable"
- Variable Name: JWT_SECRET
- Variable Value: minhas_aluminium_jwt_secret_2024
- Click "Add" or "Save"

### 1.3 Verify Variables
After adding both variables, you should see:
- MONGO_URI = mongodb+srv://habibullahaamir18_db_user:w651ezowTMXApQpL@minhasaluminium.ed28hoe.mongodb.net/minhas_db?retryWrites=true&w=majority
- JWT_SECRET = minhas_aluminium_jwt_secret_2024

### 1.4 Redeploy
- Railway will automatically redeploy your backend after adding variables
- Wait 1-2 minutes for the deployment to complete
- Check the "Deployments" tab to see the status
- Wait until you see "Success" or a green checkmark

---

## STEP 2: Verify Deployment URLs

### 2.1 Backend URL (Railway)
Your backend is deployed at:
https://minhas-aluminium-backend-production.up.railway.app

Test it by visiting:
https://minhas-aluminium-backend-production.up.railway.app
(You should see: "Minhas Aluminium & Glass API is running")

### 2.2 Frontend URL (Vercel)
Your frontend is deployed at:
https://minhas-aluminium-nqd6.vercel.app

---

## STEP 3: Test Your Application

### 3.1 Test Login
1. Go to: https://minhas-aluminium-nqd6.vercel.app/admin/login
2. Enter credentials:
   - Username: Aamir
   - Password: minhas666021
3. Click "Sign In"
4. You should be redirected to the admin dashboard

### 3.2 If Login Fails
1. Open browser Developer Tools (F12)
2. Go to "Console" tab
3. Check for any error messages
4. Go to "Network" tab
5. Try logging in again
6. Look for the "/api/auth/login" request
7. Check the response status (should be 200, not 500 or 404)

---

## STEP 4: Verify Database Connection

### 4.1 Check Railway Logs
1. In Railway dashboard, click on your backend service
2. Click on "Deployments" tab
3. Click on the latest deployment
4. Check the logs for:
   - "✅ MongoDB Connected Successfully"
   - "✅ Default admin user created (Aamir/minhas666021)" (first time only)

### 4.2 If Database Connection Fails
- Verify the MONGO_URI is correct in Railway variables
- Check MongoDB Atlas:
  1. Go to https://cloud.mongodb.com
  2. Sign in to your account
  3. Go to "Network Access"
  4. Make sure "0.0.0.0/0" is in the IP whitelist (allows all IPs)
  5. Go to "Database Access"
  6. Verify user "habibullahaamir18_db_user" exists and has read/write permissions

---

## STEP 5: Configuration Summary

### Frontend Configuration (Vercel)
✅ Environment Variable:
- VITE_API_URL = https://minhas-aluminium-backend-production.up.railway.app

✅ Vercel Deployment URL:
- https://minhas-aluminium-nqd6.vercel.app

### Backend Configuration (Railway)
✅ Environment Variables:
- MONGO_URI = mongodb+srv://habibullahaamir18_db_user:w651ezowTMXApQpL@minhasaluminium.ed28hoe.mongodb.net/minhas_db?retryWrites=true&w=majority
- JWT_SECRET = minhas_aluminium_jwt_secret_2024

✅ Railway Deployment URL:
- https://minhas-aluminium-backend-production.up.railway.app

✅ CORS Configuration:
- Allows requests from: https://minhas-aluminium-nqd6.vercel.app

### Database Configuration (MongoDB Atlas)
✅ Cluster: minhasaluminium
✅ Database: minhas_db
✅ User: habibullahaamir18_db_user

---

## STEP 6: Default Admin Credentials

Once the backend is deployed and database is connected, a default admin user will be created automatically:

**Username:** Aamir
**Password:** minhas666021

Use these credentials to log in to the admin panel at:
https://minhas-aluminium-nqd6.vercel.app/admin/login

---

## Troubleshooting

### Issue: CORS Error
**Solution:** Backend CORS is already configured for your Vercel domain. If you get CORS errors, verify the Vercel URL matches exactly.

### Issue: 404 Not Found
**Solution:** API URLs are already fixed. If you still get 404, check Railway deployment logs.

### Issue: 500 Internal Server Error
**Solution:** 
1. Check Railway environment variables are set correctly
2. Check Railway logs for database connection errors
3. Verify MongoDB Atlas network access allows all IPs (0.0.0.0/0)

### Issue: Cannot Login
**Solution:**
1. Wait for Railway to finish redeploying (1-2 minutes)
2. Check Railway logs for "MongoDB Connected Successfully"
3. Use correct credentials: Aamir / minhas666021
4. Clear browser cache and try again

---

## Next Steps After Successful Deployment

1. ✅ Test all admin panel features (add projects, services, etc.)
2. ✅ Test the public-facing website
3. ✅ Upload real project images and data
4. ✅ Update company information
5. ✅ Test contact forms
6. ✅ Test on mobile devices

---

## Important Notes

⚠️ **Security:**
- Change the default admin password after first login
- Keep your MongoDB credentials secure
- Never commit .env files to GitHub

⚠️ **Database:**
- The database name is "minhas_db"
- All collections will be created automatically when you add data

⚠️ **Deployment:**
- Railway auto-deploys when you push to GitHub
- Vercel auto-deploys when you push to GitHub
- Both deployments take 1-2 minutes

---

## Support

If you encounter any issues:
1. Check Railway deployment logs
2. Check browser console for errors
3. Verify all environment variables are set correctly
4. Ensure MongoDB Atlas allows connections from all IPs

---

Last Updated: December 5, 2024
